#include "character.hpp"
#include "elona.hpp"
#include "random.hpp"
#include "variables.hpp"


namespace
{


struct character_generation_info
{
    int id;
    int level;
    int fltselect;
    int category;
    const char* race;
    int rarity;
    int coefficient;
};



const character_generation_info character_generation_info_table[] = {
    {
        0,
        1,
        1,
        0,
        u8"slime",
        100000,
        400,
    },
    {
        343,
        1,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        1,
        35,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        353,
        22,
        1,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        70,
        20,
        1,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        69,
        20,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        73,
        40,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        74,
        20,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        206,
        50,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        38,
        20,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        40,
        40,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        333,
        69,
        1,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        76,
        40,
        9,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        77,
        40,
        9,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        204,
        10,
        9,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        2,
        55,
        3,
        0,
        u8"elea",
        100000,
        400,
    },
    {
        37,
        1,
        1,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        23,
        20,
        3,
        0,
        u8"juere",
        1000,
        400,
    },
    {
        26,
        6,
        2,
        0,
        u8"norland",
        1000,
        400,
    },
    {
        27,
        42,
        2,
        0,
        u8"norland",
        1000,
        400,
    },
    {
        28,
        78,
        3,
        0,
        u8"juere",
        1000,
        400,
    },
    {
        29,
        50,
        3,
        0,
        u8"juere",
        1000,
        400,
    },
    {
        140,
        25,
        3,
        0,
        u8"dragon",
        1000,
        400,
    },
    {
        30,
        20,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        31,
        20,
        3,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        351,
        130,
        3,
        0,
        u8"cat",
        100000,
        400,
    },
    {
        352,
        1,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        32,
        20,
        2,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        33,
        20,
        3,
        0,
        u8"elea",
        100000,
        400,
    },
    {
        34,
        20,
        3,
        0,
        u8"elea",
        100000,
        400,
    },
    {
        139,
        10,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        146,
        10,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        142,
        10,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        141,
        28,
        3,
        0,
        u8"lich",
        100000,
        400,
    },
    {
        143,
        25,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        144,
        24,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        145,
        16,
        3,
        0,
        u8"dragon",
        100000,
        400,
    },
    {
        306,
        350,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        331,
        350,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        336,
        1200,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        338,
        350,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        339,
        350,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        342,
        350,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        340,
        1200,
        3,
        0,
        u8"god",
        100000,
        400,
    },
    {
        3,
        1,
        0,
        3,
        u8"slime",
        80000,
        400,
    },
    {
        4,
        4,
        0,
        3,
        u8"slime",
        70000,
        400,
    },
    {
        169,
        10,
        0,
        3,
        u8"slime",
        70000,
        400,
    },
    {
        194,
        16,
        0,
        3,
        u8"slime",
        70000,
        400,
    },
    {
        286,
        9,
        0,
        0,
        u8"slime",
        25000,
        400,
    },
    {
        285,
        22,
        0,
        0,
        u8"slime",
        25000,
        400,
    },
    {
        287,
        20,
        0,
        0,
        u8"drake",
        25000,
        400,
    },
    {
        327,
        52,
        0,
        0,
        u8"machine",
        15000,
        400,
    },
    {
        5,
        1,
        0,
        0,
        u8"rabbit",
        100000,
        400,
    },
    {
        6,
        1,
        0,
        0,
        u8"snail",
        100000,
        400,
    },
    {
        7,
        3,
        0,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        8,
        4,
        5,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        9,
        2,
        5,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        269,
        5,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        320,
        32,
        9,
        0,
        u8"norland",
        10000,
        100,
    },
    {
        273,
        5,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        326,
        16,
        7,
        0,
        u8"juere",
        2000,
        400,
    },
    {
        270,
        5,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        349,
        12,
        1,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        348,
        35,
        3,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        347,
        5,
        1,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        271,
        8,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        335,
        8,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        337,
        3,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        272,
        6,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        274,
        10,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        289,
        26,
        9,
        0,
        u8"eulderna",
        2000,
        400,
    },
    {
        293,
        26,
        9,
        0,
        u8"juere",
        2000,
        400,
    },
    {
        295,
        26,
        9,
        0,
        u8"norland",
        2000,
        400,
    },
    {
        35,
        1,
        5,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        36,
        1,
        5,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        174,
        1,
        0,
        0,
        u8"norland",
        60000,
        400,
    },
    {
        10,
        1,
        0,
        0,
        u8"sheep",
        30000,
        400,
    },
    {
        11,
        2,
        0,
        0,
        u8"frog",
        100000,
        400,
    },
    {
        12,
        3,
        0,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        13,
        3,
        0,
        5,
        u8"kobolt",
        100000,
        400,
    },
    {
        236,
        2,
        0,
        7,
        u8"yeek",
        100000,
        400,
    },
    {
        238,
        6,
        0,
        7,
        u8"yeek",
        100000,
        400,
    },
    {
        241,
        4,
        0,
        7,
        u8"yeek",
        100000,
        400,
    },
    {
        240,
        9,
        0,
        7,
        u8"yeek",
        50000,
        400,
    },
    {
        237,
        6,
        0,
        12,
        u8"yeek",
        150000,
        400,
    },
    {
        244,
        18,
        0,
        12,
        u8"norland",
        25000,
        400,
    },
    {
        245,
        25,
        0,
        0,
        u8"rock",
        20000,
        400,
    },
    {
        321,
        10,
        0,
        0,
        u8"norland",
        15000,
        200,
    },
    {
        242,
        14,
        3,
        7,
        u8"yeek",
        100000,
        400,
    },
    {
        239,
        5,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        14,
        4,
        0,
        0,
        u8"centipede",
        100000,
        400,
    },
    {
        15,
        4,
        0,
        0,
        u8"mushroom",
        50000,
        400,
    },
    {
        283,
        8,
        0,
        0,
        u8"mushroom",
        50000,
        400,
    },
    {
        284,
        21,
        0,
        0,
        u8"mushroom",
        50000,
        400,
    },
    {
        16,
        5,
        7,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        39,
        5,
        7,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        171,
        5,
        7,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        172,
        5,
        7,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        173,
        20,
        7,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        71,
        5,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        72,
        5,
        1,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        79,
        25,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        80,
        35,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        17,
        5,
        0,
        2,
        u8"orc",
        100000,
        400,
    },
    {
        281,
        7,
        0,
        0,
        u8"lizardman",
        100000,
        400,
    },
    {
        282,
        18,
        0,
        0,
        u8"minotaur",
        70000,
        400,
    },
    {
        296,
        22,
        0,
        0,
        u8"minotaur",
        70000,
        400,
    },
    {
        298,
        23,
        0,
        0,
        u8"minotaur",
        70000,
        400,
    },
    {
        299,
        25,
        0,
        0,
        u8"minotaur",
        40000,
        400,
    },
    {
        300,
        31,
        3,
        0,
        u8"minotaur",
        40000,
        400,
    },
    {
        251,
        14,
        0,
        2,
        u8"troll",
        100000,
        400,
    },
    {
        18,
        5,
        0,
        4,
        u8"elea",
        100000,
        400,
    },
    {
        24,
        5,
        0,
        4,
        u8"elea",
        100000,
        400,
    },
    {
        309,
        12,
        0,
        0,
        u8"asura",
        100000,
        400,
    },
    {
        310,
        26,
        0,
        0,
        u8"asura",
        100000,
        400,
    },
    {
        311,
        37,
        0,
        0,
        u8"asura",
        100000,
        400,
    },
    {
        41,
        5,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        75,
        5,
        7,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        19,
        5,
        0,
        0,
        u8"mandrake",
        100000,
        400,
    },
    {
        22,
        5,
        0,
        0,
        u8"beetle",
        100000,
        400,
    },
    {
        20,
        10,
        0,
        2,
        u8"orc",
        100000,
        400,
    },
    {
        25,
        25,
        2,
        2,
        u8"orc",
        100000,
        400,
    },
    {
        21,
        8,
        0,
        9,
        u8"zombie",
        100000,
        400,
    },
    {
        42,
        1,
        0,
        0,
        u8"bat",
        100000,
        400,
    },
    {
        43,
        10,
        0,
        0,
        u8"bat",
        70000,
        400,
    },
    {
        44,
        30,
        0,
        0,
        u8"bat",
        60000,
        400,
    },
    {
        45,
        15,
        0,
        0,
        u8"ent",
        100000,
        400,
    },
    {
        46,
        15,
        0,
        0,
        u8"ent",
        100000,
        400,
    },
    {
        47,
        20,
        0,
        0,
        u8"lich",
        60000,
        400,
    },
    {
        48,
        30,
        0,
        0,
        u8"lich",
        50000,
        400,
    },
    {
        49,
        45,
        0,
        0,
        u8"lich",
        40000,
        400,
    },
    {
        307,
        18,
        0,
        0,
        u8"lich",
        10000,
        400,
    },
    {
        308,
        35,
        0,
        0,
        u8"lich",
        10000,
        400,
    },
    {
        50,
        5,
        0,
        0,
        u8"hound",
        80000,
        400,
    },
    {
        51,
        10,
        0,
        14,
        u8"hound",
        70000,
        400,
    },
    {
        52,
        10,
        0,
        15,
        u8"hound",
        70000,
        400,
    },
    {
        53,
        12,
        0,
        16,
        u8"hound",
        70000,
        400,
    },
    {
        54,
        12,
        0,
        17,
        u8"hound",
        70000,
        400,
    },
    {
        55,
        18,
        0,
        18,
        u8"hound",
        50000,
        400,
    },
    {
        56,
        18,
        0,
        19,
        u8"hound",
        50000,
        400,
    },
    {
        57,
        15,
        0,
        20,
        u8"hound",
        50000,
        400,
    },
    {
        58,
        22,
        0,
        21,
        u8"hound",
        40000,
        400,
    },
    {
        59,
        25,
        0,
        22,
        u8"hound",
        40000,
        400,
    },
    {
        60,
        30,
        0,
        23,
        u8"hound",
        40000,
        400,
    },
    {
        61,
        4,
        0,
        0,
        u8"rabbit",
        100000,
        400,
    },
    {
        62,
        10,
        0,
        0,
        u8"rabbit",
        100000,
        400,
    },
    {
        63,
        7,
        0,
        0,
        u8"ghost",
        100000,
        400,
    },
    {
        64,
        3,
        0,
        0,
        u8"ghost",
        70000,
        400,
    },
    {
        312,
        8,
        0,
        0,
        u8"ent",
        40000,
        400,
    },
    {
        313,
        19,
        0,
        0,
        u8"ent",
        40000,
        400,
    },
    {
        65,
        12,
        0,
        0,
        u8"spirit",
        100000,
        400,
    },
    {
        66,
        30,
        0,
        0,
        u8"spirit",
        100000,
        400,
    },
    {
        67,
        2,
        0,
        0,
        u8"eye",
        80000,
        400,
    },
    {
        315,
        14,
        0,
        0,
        u8"eye",
        60000,
        400,
    },
    {
        316,
        7,
        0,
        0,
        u8"eye",
        60000,
        400,
    },
    {
        314,
        29,
        0,
        0,
        u8"eye",
        60000,
        400,
    },
    {
        68,
        20,
        0,
        0,
        u8"wyvern",
        50000,
        400,
    },
    {
        78,
        15,
        0,
        0,
        u8"eulderna",
        100000,
        400,
    },
    {
        81,
        5,
        0,
        0,
        u8"wasp",
        100000,
        400,
    },
    {
        82,
        10,
        0,
        0,
        u8"wasp",
        100000,
        400,
    },
    {
        83,
        22,
        0,
        0,
        u8"giant",
        60000,
        400,
    },
    {
        84,
        40,
        0,
        0,
        u8"giant",
        50000,
        400,
    },
    {
        85,
        7,
        0,
        0,
        u8"imp",
        100000,
        400,
    },
    {
        86,
        16,
        0,
        0,
        u8"imp",
        100000,
        400,
    },
    {
        87,
        27,
        0,
        0,
        u8"imp",
        100000,
        400,
    },
    {
        88,
        4,
        0,
        0,
        u8"hand",
        100000,
        400,
    },
    {
        89,
        11,
        0,
        0,
        u8"hand",
        100000,
        400,
    },
    {
        90,
        15,
        0,
        0,
        u8"hand",
        100000,
        400,
    },
    {
        91,
        5,
        0,
        0,
        u8"ghost",
        100000,
        400,
    },
    {
        92,
        13,
        0,
        0,
        u8"ghost",
        100000,
        400,
    },
    {
        93,
        8,
        0,
        0,
        u8"mandrake",
        100000,
        400,
    },
    {
        94,
        19,
        0,
        0,
        u8"mandrake",
        100000,
        400,
    },
    {
        95,
        10,
        0,
        0,
        u8"snake",
        100000,
        400,
    },
    {
        96,
        18,
        0,
        0,
        u8"snake",
        100000,
        400,
    },
    {
        97,
        16,
        0,
        0,
        u8"drake",
        100000,
        400,
    },
    {
        98,
        16,
        0,
        0,
        u8"drake",
        100000,
        400,
    },
    {
        99,
        7,
        0,
        13,
        u8"zombie",
        100000,
        400,
    },
    {
        100,
        14,
        0,
        13,
        u8"zombie",
        100000,
        400,
    },
    {
        101,
        22,
        0,
        13,
        u8"zombie",
        100000,
        400,
    },
    {
        257,
        28,
        3,
        13,
        u8"zombie",
        100000,
        400,
    },
    {
        254,
        19,
        0,
        13,
        u8"zombie",
        50000,
        400,
    },
    {
        102,
        2,
        0,
        1,
        u8"goblin",
        100000,
        400,
    },
    {
        103,
        6,
        0,
        1,
        u8"goblin",
        100000,
        400,
    },
    {
        104,
        8,
        0,
        1,
        u8"goblin",
        100000,
        400,
    },
    {
        105,
        10,
        0,
        1,
        u8"goblin",
        100000,
        400,
    },
    {
        106,
        12,
        0,
        0,
        u8"ghost",
        100000,
        400,
    },
    {
        107,
        12,
        0,
        0,
        u8"ghost",
        100000,
        400,
    },
    {
        108,
        4,
        0,
        11,
        u8"bear",
        100000,
        400,
    },
    {
        109,
        10,
        0,
        11,
        u8"bear",
        100000,
        400,
    },
    {
        344,
        28,
        0,
        11,
        u8"bear",
        50000,
        400,
    },
    {
        110,
        15,
        0,
        0,
        u8"armor",
        40000,
        400,
    },
    {
        111,
        25,
        0,
        0,
        u8"armor",
        30000,
        400,
    },
    {
        112,
        35,
        0,
        0,
        u8"armor",
        30000,
        400,
    },
    {
        113,
        45,
        0,
        0,
        u8"armor",
        30000,
        400,
    },
    {
        114,
        22,
        0,
        0,
        u8"medusa",
        100000,
        400,
    },
    {
        115,
        33,
        0,
        0,
        u8"medusa",
        100000,
        400,
    },
    {
        116,
        44,
        0,
        0,
        u8"medusa",
        100000,
        400,
    },
    {
        117,
        8,
        0,
        0,
        u8"cupid",
        100000,
        400,
    },
    {
        118,
        9,
        0,
        0,
        u8"phantom",
        100000,
        400,
    },
    {
        248,
        30,
        0,
        0,
        u8"dinosaur",
        50000,
        400,
    },
    {
        119,
        13,
        0,
        0,
        u8"harpy",
        100000,
        400,
    },
    {
        120,
        32,
        0,
        0,
        u8"dragon",
        30000,
        400,
    },
    {
        121,
        40,
        0,
        0,
        u8"dragon",
        20000,
        400,
    },
    {
        122,
        40,
        0,
        0,
        u8"dragon",
        20000,
        400,
    },
    {
        123,
        40,
        0,
        0,
        u8"dragon",
        20000,
        400,
    },
    {
        124,
        45,
        0,
        0,
        u8"dragon",
        10000,
        400,
    },
    {
        125,
        50,
        0,
        0,
        u8"dragon",
        10000,
        400,
    },
    {
        126,
        23,
        0,
        0,
        u8"cerberus",
        40000,
        400,
    },
    {
        255,
        4,
        0,
        0,
        u8"centipede",
        100000,
        400,
    },
    {
        256,
        24,
        0,
        0,
        u8"centipede",
        100000,
        400,
    },
    {
        127,
        3,
        0,
        6,
        u8"spider",
        100000,
        400,
    },
    {
        128,
        11,
        0,
        6,
        u8"spider",
        100000,
        400,
    },
    {
        129,
        21,
        0,
        6,
        u8"spider",
        100000,
        400,
    },
    {
        130,
        15,
        0,
        6,
        u8"spider",
        100000,
        400,
    },
    {
        131,
        28,
        0,
        6,
        u8"spider",
        100000,
        400,
    },
    {
        132,
        13,
        0,
        0,
        u8"golem",
        40000,
        400,
    },
    {
        133,
        19,
        0,
        0,
        u8"golem",
        40000,
        400,
    },
    {
        134,
        25,
        0,
        0,
        u8"golem",
        40000,
        400,
    },
    {
        135,
        30,
        0,
        0,
        u8"golem",
        30000,
        400,
    },
    {
        136,
        35,
        0,
        0,
        u8"golem",
        20000,
        400,
    },
    {
        137,
        40,
        0,
        0,
        u8"golem",
        15000,
        400,
    },
    {
        138,
        50,
        0,
        0,
        u8"golem",
        15000,
        400,
    },
    {
        147,
        16,
        0,
        0,
        u8"crab",
        100000,
        400,
    },
    {
        148,
        18,
        0,
        0,
        u8"centipede",
        100000,
        400,
    },
    {
        149,
        20,
        0,
        0,
        u8"goblin",
        100000,
        400,
    },
    {
        150,
        12,
        0,
        9,
        u8"skeleton",
        100000,
        400,
    },
    {
        151,
        20,
        0,
        9,
        u8"skeleton",
        100000,
        400,
    },
    {
        152,
        20,
        0,
        9,
        u8"eulderna",
        100000,
        400,
    },
    {
        153,
        12,
        0,
        0,
        u8"piece",
        100000,
        400,
    },
    {
        154,
        16,
        0,
        0,
        u8"piece",
        100000,
        400,
    },
    {
        155,
        18,
        0,
        0,
        u8"piece",
        100000,
        400,
    },
    {
        156,
        18,
        0,
        0,
        u8"piece",
        100000,
        400,
    },
    {
        157,
        22,
        0,
        0,
        u8"piece",
        100000,
        400,
    },
    {
        158,
        22,
        0,
        0,
        u8"piece",
        100000,
        400,
    },
    {
        159,
        20,
        0,
        8,
        u8"norland",
        25000,
        400,
    },
    {
        160,
        20,
        0,
        8,
        u8"norland",
        25000,
        400,
    },
    {
        161,
        20,
        0,
        8,
        u8"norland",
        25000,
        400,
    },
    {
        302,
        12,
        3,
        0,
        u8"juere",
        25000,
        400,
    },
    {
        303,
        10,
        0,
        0,
        u8"juere",
        25000,
        400,
    },
    {
        304,
        10,
        0,
        0,
        u8"juere",
        25000,
        400,
    },
    {
        305,
        10,
        0,
        0,
        u8"juere",
        25000,
        400,
    },
    {
        162,
        5,
        0,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        234,
        22,
        0,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        231,
        45,
        3,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        232,
        17,
        0,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        233,
        7,
        0,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        235,
        15,
        0,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        163,
        9,
        0,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        164,
        4,
        0,
        0,
        u8"cat",
        100000,
        400,
    },
    {
        246,
        3,
        0,
        0,
        u8"cat",
        1000,
        0,
    },
    {
        332,
        9,
        0,
        0,
        u8"cat",
        10000,
        0,
    },
    {
        229,
        18,
        0,
        10,
        u8"cat",
        100000,
        400,
    },
    {
        230,
        25,
        3,
        0,
        u8"catgod",
        100000,
        400,
    },
    {
        228,
        20,
        0,
        0,
        u8"cat",
        100000,
        400,
    },
    {
        165,
        4,
        0,
        10,
        u8"dog",
        100000,
        400,
    },
    {
        225,
        1,
        3,
        0,
        u8"dog",
        100000,
        400,
    },
    {
        226,
        4,
        3,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        227,
        5,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        166,
        4,
        0,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        167,
        1,
        0,
        0,
        u8"rat",
        100000,
        400,
    },
    {
        168,
        1,
        0,
        0,
        u8"shell",
        100000,
        400,
    },
    {
        170,
        1,
        0,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        175,
        80,
        3,
        0,
        u8"catgod",
        100000,
        400,
    },
    {
        176,
        1,
        1,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        249,
        50,
        1,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        210,
        1,
        1,
        0,
        u8"catsister",
        100000,
        400,
    },
    {
        211,
        1,
        1,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        177,
        80,
        3,
        0,
        u8"machinegod",
        100000,
        400,
    },
    {
        178,
        80,
        3,
        0,
        u8"undeadgod",
        100000,
        400,
    },
    {
        179,
        35,
        1,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        208,
        45,
        3,
        0,
        u8"dwarf",
        100000,
        400,
    },
    {
        209,
        45,
        3,
        0,
        u8"dwarf",
        100000,
        400,
    },
    {
        180,
        1,
        4,
        0,
        u8"cat",
        100000,
        400,
    },
    {
        181,
        10,
        4,
        0,
        u8"hound",
        100000,
        400,
    },
    {
        182,
        8,
        0,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        183,
        15,
        7,
        0,
        u8"norland",
        20000,
        400,
    },
    {
        184,
        9,
        7,
        0,
        u8"norland",
        40000,
        400,
    },
    {
        185,
        20,
        7,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        350,
        10,
        1,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        186,
        5,
        0,
        0,
        u8"machine",
        100000,
        400,
    },
    {
        187,
        13,
        0,
        0,
        u8"machine",
        100000,
        400,
    },
    {
        188,
        30,
        0,
        0,
        u8"machine",
        100000,
        400,
    },
    {
        345,
        22,
        3,
        0,
        u8"bike",
        100000,
        400,
    },
    {
        346,
        8,
        0,
        0,
        u8"bike",
        5000,
        400,
    },
    {
        341,
        15,
        0,
        0,
        u8"machine",
        25000,
        400,
    },
    {
        258,
        25,
        0,
        0,
        u8"machine",
        50000,
        400,
    },
    {
        189,
        8,
        0,
        0,
        u8"eye",
        60000,
        400,
    },
    {
        190,
        19,
        0,
        0,
        u8"eye",
        60000,
        400,
    },
    {
        191,
        14,
        0,
        0,
        u8"wisp",
        50000,
        400,
    },
    {
        192,
        5,
        0,
        0,
        u8"crab",
        100000,
        400,
    },
    {
        193,
        15,
        0,
        0,
        u8"crab",
        70000,
        400,
    },
    {
        195,
        1,
        0,
        0,
        u8"chicken",
        30000,
        400,
    },
    {
        196,
        7,
        0,
        0,
        u8"mandrake",
        60000,
        400,
    },
    {
        201,
        5,
        0,
        0,
        u8"mandrake",
        20000,
        400,
    },
    {
        197,
        18,
        0,
        0,
        u8"mandrake",
        60000,
        400,
    },
    {
        198,
        30,
        0,
        0,
        u8"mandrake",
        60000,
        400,
    },
    {
        199,
        12,
        0,
        0,
        u8"stalker",
        30000,
        400,
    },
    {
        200,
        26,
        0,
        0,
        u8"stalker",
        30000,
        400,
    },
    {
        202,
        80,
        3,
        0,
        u8"giant",
        100000,
        400,
    },
    {
        203,
        10,
        1,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        205,
        1,
        1,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        207,
        30,
        3,
        0,
        u8"giant",
        100000,
        400,
    },
    {
        212,
        1,
        3,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        213,
        1,
        3,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        221,
        10,
        3,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        222,
        15,
        3,
        0,
        u8"roran",
        100000,
        400,
    },
    {
        223,
        10,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        224,
        7,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        243,
        15,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        247,
        4,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        252,
        45,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        253,
        25,
        3,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        259,
        20,
        3,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        301,
        38,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        214,
        2,
        0,
        0,
        u8"juere",
        30000,
        400,
    },
    {
        215,
        5,
        0,
        0,
        u8"juere",
        30000,
        400,
    },
    {
        217,
        35,
        0,
        0,
        u8"juere",
        30000,
        400,
    },
    {
        216,
        50,
        0,
        0,
        u8"yith",
        20000,
        400,
    },
    {
        218,
        45,
        0,
        0,
        u8"yith",
        40000,
        400,
    },
    {
        219,
        38,
        0,
        0,
        u8"orc",
        80000,
        400,
    },
    {
        220,
        65,
        0,
        0,
        u8"yith",
        30000,
        400,
    },
    {
        250,
        13,
        0,
        0,
        u8"fairy",
        50000,
        400,
    },
    {
        260,
        8,
        3,
        0,
        u8"servant",
        50000,
        400,
    },
    {
        261,
        8,
        3,
        0,
        u8"servant",
        50000,
        400,
    },
    {
        262,
        8,
        3,
        0,
        u8"servant",
        50000,
        400,
    },
    {
        263,
        8,
        3,
        0,
        u8"servant",
        50000,
        400,
    },
    {
        264,
        8,
        3,
        0,
        u8"servant",
        50000,
        400,
    },
    {
        265,
        8,
        3,
        0,
        u8"servant",
        50000,
        400,
    },
    {
        266,
        8,
        3,
        0,
        u8"servant",
        50000,
        400,
    },
    {
        267,
        1,
        0,
        0,
        u8"horse",
        10000,
        400,
    },
    {
        276,
        4,
        0,
        0,
        u8"horse",
        10000,
        400,
    },
    {
        275,
        10,
        0,
        0,
        u8"horse",
        10000,
        400,
    },
    {
        268,
        15,
        0,
        0,
        u8"horse",
        10000,
        400,
    },
    {
        277,
        20,
        0,
        0,
        u8"horse",
        10000,
        400,
    },
    {
        278,
        6,
        0,
        0,
        u8"mutant",
        70000,
        400,
    },
    {
        279,
        15,
        3,
        0,
        u8"yerles",
        100000,
        400,
    },
    {
        280,
        10,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        288,
        55,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        290,
        38,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        292,
        55,
        3,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        294,
        38,
        3,
        0,
        u8"juere",
        100000,
        400,
    },
    {
        291,
        55,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        297,
        38,
        3,
        0,
        u8"norland",
        100000,
        400,
    },
    {
        317,
        28,
        0,
        0,
        u8"roran",
        50000,
        400,
    },
    {
        318,
        30,
        3,
        0,
        u8"machinegod",
        50000,
        400,
    },
    {
        319,
        1,
        3,
        0,
        u8"mutant",
        50000,
        400,
    },
    {
        322,
        15,
        3,
        0,
        u8"roran",
        50000,
        400,
    },
    {
        334,
        7,
        3,
        0,
        u8"juere",
        50000,
        400,
    },
    {
        323,
        12,
        0,
        0,
        u8"ghost",
        10000,
        0,
    },
    {
        324,
        10,
        0,
        0,
        u8"quickling",
        15000,
        400,
    },
    {
        325,
        17,
        0,
        0,
        u8"quickling",
        15000,
        400,
    },
    {
        328,
        3,
        0,
        0,
        u8"metal",
        2000,
        0,
    },
    {
        329,
        1,
        0,
        0,
        u8"metal",
        5000,
        0,
    },
    {
        330,
        19,
        0,
        0,
        u8"dinosaur",
        40000,
        400,
    },
};


struct character_id
{
    int id;
    int cnpcid; // It is used only if id equals 343.
};


} // namespace



namespace elona
{


void get_random_npc_id()
{
    weighted_random_sampler<character_id> sampler;

    for (const auto& info : character_generation_info_table)
    {
        if (info.level > objlv)
            continue;
        if (fltselect != info.fltselect)
            continue;
        if (flttypemajor != 0 && flttypemajor != info.category)
            continue;
        if (!std::empty(fltnrace(0)) && fltnrace(0) != info.race)
            continue;
        if (filtermax != 0)
        {
            // FIXME: use std::all_of
            bool ok = true;
            for (int i = 0; i < filtermax; ++i)
            {
                if (filter_creature(info.id).find(filtern(i))
                    == std::string::npos)
                {
                    ok = false;
                    break;
                }
            }
            if (!ok)
                continue;
        }
        sampler.add(
            {info.id, 0},
            info.rarity
                    / (500 + std::abs(info.level - objlv) * info.coefficient)
                + 1);
    }

    if (!cmshade)
    {
        for (int i = 0; i < usernpcmax; ++i)
        {
            if (userdata(2, i) > objlv)
                continue;
            if (fltselect != userdata(12, i))
                continue;
            if (flttypemajor != 0)
                continue;
            if (!std::empty(fltnrace(0)) && fltnrace(0) != userdatan(2, i))
                continue;
            if (filtermax != 0)
            {
                // FIXME: use std::all_of
                bool ok = false;
                for (int j = 0; j < filtermax; ++j)
                {
                    if (userdatan(4, i).find(filtern(j)) == std::string::npos)
                    {
                        ok = false;
                        break;
                    }
                }
                if (!ok)
                    continue;
            }
            sampler.add(
                {343, i},
                std::clamp(userdata(6, i), 1'000, 500'000)
                        / (500 + std::abs(userdata(2, i) - objlv) * 400)
                    + 1);
        }
    }

    const auto [id, cnpcid] = sampler.get().value_or(character_id{0, 0});
    dbid = id;
    if (id == 343)
    {
        cdata[rc].cnpc_id = cnpcid;
    }
}



} // namespace elona
